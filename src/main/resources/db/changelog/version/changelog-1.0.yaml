databaseChangeLog:
  - changeSet:
      id: "create-users-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "users"
      changes:
        - createTable:
            tableName: "users"
            columns:
              - column:
                  name: "id"
                  type: "BIGINT"
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    primaryKeyName: "pk_users"
                    nullable: false
              - column:
                  name: "email"
                  type: "VARCHAR(320)"
                  constraints:
                    unique: true
                    uniqueConstraintName: "email"
                    nullable: false
              - column:
                  name: "password"
                  type: "VARCHAR(80)"
                  constraints:
                    nullable: false
              - column:
                  name: "locked"
                  type: "BOOLEAN"
                  defaultValueBoolean: false
                  constraints:
                    nullable: false
              - column:
                  name: "enabled"
                  type: "BOOLEAN"
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: "verified"
                  type: "BOOLEAN"
                  defaultValueBoolean: false
                  constraints:
                    nullable: false
              - column:
                  name: "created_at"
                  type: "TIMESTAMP"
                  constraints:
                    nullable: false
              - column:
                  name: "login_attempts"
                  type: "TINYINT"
                  constraints:
                    nullable: false
              - column:
                  name: "last_login_attempt"
                  type: "TIMESTAMP"
              - column:
                  name: "last_login"
                  type: "DATE"
                  constraints:
                    nullable: false

  - changeSet:
      id: "create-users_info-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "users_info"
      changes:
        - createTable:
            tableName: "users_info"
            columns:
              - column:
                  name: "user_id"
                  type: "BIGINT"
                  constraints:
                    primaryKey: true
                    primaryKeyName: "pk_users_info"
                    foreignKeyName: "fk_users"
                    references: "users(id)"
                    deleteCascade: true
                    nullable: false
              - column:
                  name: "first_name"
                  type: "VARCHAR(255)"
                  constraints:
                    nullable: false
              - column:
                  name: "last_name"
                  type: "VARCHAR(255)"
                  constraints:
                    nullable: false
              - column:
                  name: "avatar_url"
                  type: "VARCHAR(255)"

  - changeSet:
      id: "create-roles-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "roles"
      changes:
        - createTable:
            tableName: "roles"
            columns:
              - column:
                  name: "id"
                  type: "BIGINT"
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    primaryKeyName: "pk_roles"
                    nullable: false
              - column:
                  name: "role"
                  type: "VARCHAR(255)"
                  constraints:
                    nullable: false
                    unique: true
                    uniqueConstraintName: "role"
              - column:
                  name: "description"
                  type: "VARCHAR(255)"
                  constraints:
                    nullable: false

  - changeSet:
      id: "create-users_roles-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "users_roles"
      changes:
        - createTable:
            tableName: "users_roles"
            columns:
              - column:
                  name: "user_id"
                  type: "BIGINT"
                  constraints:
                    foreignKeyName: "fk_users_roles_users"
                    references: "users(id)"
                    primaryKey: true
                    primaryKeyName: "cpk_users_roles"
                    nullable: false
              - column:
                  name: "role_id"
                  type: "BIGINT"
                  constraints:
                    foreignKeyName: "fk_users_roles_roles"
                    references: "roles(id)"
                    primaryKey: true
                    primaryKeyName: "cpk_users_roles"
                    nullable: false

  - changeSet:
      id: "create-todo_lists-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "todo_lists"
      changes:
        - createTable:
            tableName: "todo_lists"
            columns:
              - column:
                  name: "id"
                  type: "BIGINT"
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    primaryKeyName: "pk_todo_lists"
                    nullable: false
              - column:
                  name: "user_id"
                  type: "BIGINT"
                  constraints:
                    foreignKeyName: "fk_todo_lists_users"
                    references: "users(id)"
                    deleteCascade: true
                    nullable: false
              - column:
                  name: "title"
                  type: "VARCHAR(255)"
              - column:
                  name: "type"
                  type: "VARCHAR(64)"
                  constraints:
                    nullable: false
              - column:
                  name: "created_at"
                  type: "TIMESTAMP"
                  constraints:
                    nullable: false
              - column:
                  name: "due_date"
                  type: "DATE"

  - changeSet:
      id: "create-todos-table"
      author: "Ian Oliveira"
      preConditions:
        - onFail: "MARK_RAN"
        - not:
            - tableExists:
                tableName: "todos"
      changes:
        - createTable:
            tableName: "todos"
            columns:
              - column:
                  name: "id"
                  type: "BIGINT"
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    primaryKeyName: "pk_todos"
                    nullable: false
              - column:
                  name: "todo_list_id"
                  type: "BIGINT"
                  constraints:
                    foreignKeyName: "fk_todos_todo_lists"
                    references: "todo_lists(id)"
                    deleteCascade: true
                    nullable: false
              - column:
                  name: "task"
                  type: "VARCHAR(255)"
                  constraints:
                    nullable: false
              - column:
                  name: "completed"
                  type: "BOOLEAN"
                  defaultValueBoolean: false
                  constraints:
                    nullable: false
              - column:
                  name: "position"
                  type: "INT"
                  constraints:
                    nullable: false
              - column:
                  name: "created_at"
                  type: "TIMESTAMP"
                  constraints:
                    nullable: false
              - column:
                  name: "due_date"
                  type: "DATE"
